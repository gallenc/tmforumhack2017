<blueprint xmlns="http://www.osgi.org/xmlns/blueprint/v1.0.0">

  <!-- print startup message to karaf consol -->
  <bean id="sayHello" class="org.opennms.plugins.dbnotifier.SayHello" destroy-method="destroyMethod">
    <!-- <argument ref="licenceService" /> -->
  </bean>

  <!-- opennms event proxy -->
  <!-- note optional so that we can run tests outside of opennms -->
  <reference id="eventProxy" interface="org.opennms.netmgt.events.api.EventProxy" availability="optional" timeout="100" />


  <bean id="databaseChangeNotifierClient" class="org.opennms.plugins.dbnotifier.DbNotificationClientQueueImpl" init-method="init" destroy-method="destroy">
    <property name="databaseChangeNotifier" ref="databaseChangeNotifier" />
    <property name="maxQueueLength" value="1000" />

    <property name="channelHandlingClients">
      <map>
        <!-- <entry key="opennms_alarm_changes" value-ref="verySimpleClient" /> -->
        <entry key="opennms_alarm_changes" value-ref="alarmChangeNotificationClient" />
        <!-- <entry key="opennms_event_changes" value-ref="verySimpleClient"/> -->
        <entry key="opennms_memos_changes" value-ref="memosChangeNotificationClient" />
      </map>
    </property>
  </bean>

  <!-- used for testing only -->
  <!-- <bean id="verySimpleClient" class="org.opennms.plugins.dbnotifier.VerySimpleNotificationClient" /> -->

  <bean id="alarmChangeNotificationClient" class="org.opennms.plugins.dbnotifier.alarmnotifier.AlarmChangeNotificationClient" init-method="init"
    destroy-method="destroy">
    <property name="eventProxy" ref="eventProxy" />
  </bean>

  <bean id="memosChangeNotificationClient" class="org.opennms.plugins.dbnotifier.alarmnotifier.MemosChangeNotificationClient" init-method="init"
    destroy-method="destroy">
    <property name="eventProxy" ref="eventProxy" />
  </bean>

  <!-- DatabaseChangeNotifier(DataSource dataSource, List<String> paramList) -->
  <bean id="databaseChangeNotifier" class="org.opennms.plugins.dbnotifier.DatabaseChangeNotifier" init-method="init" destroy-method="destroy">
    <argument index="0" ref="pgDataSourceFactory" />

    <argument index="1">
      <list>
        <value>NOTIFY_ALARM_CHANGES</value>
        <!-- <value>NOTIFY_EVENT_CHANGES</value> -->
        <value>NOTIFY_MEMOS_CHANGES</value>
      </list>
    </argument>

    <property name="connectionStatementEvents" ref="connectionStatementEvents" />
    <property name="disConnectionStatementEvents" ref="disConnectionStatementEvents" />
    <property name="connectionStatementAlarms" ref="connectionStatementAlarms" />
    <property name="disConnectionStatementAlarms" ref="disConnectionStatementAlarms" />
    <property name="connectionStatementMemos" ref="connectionStatementMemos" />
    <property name="disConnectionStatementMemos" ref="disConnectionStatementMemos" />
  </bean>





</blueprint>
